name: cicd

on:
  push:
    branches:
      - main

jobs:
  tailscale:
    name: Tailscale
    uses: tailscale/github-action@v4
    with:
      oauth-client-id: ${{ secrets.TS_OAUTH_CLIENT_ID }}
      oauth-secret: ${{ secrets.TS_OAUTH_SECRET }}
      tags: tag:ci
  deploy:
    name: Deploy to server
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Dokploy deploy
        run: |
          curl -X POST "${{ secrets.DOKPLOY_WEBHOOK_URL }}"

